THREE.OrbitControls=function(a,b){function c(){return 2*Math.PI/60/60*L.autoRotateSpeed}function d(){return Math.pow(.95,L.zoomSpeed)}function e(a){T.theta-=a}function f(a){T.phi-=a}function g(a){L.object.isPerspectiveCamera?U/=a:L.object.isOrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom*a)),L.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function h(a){L.object.isPerspectiveCamera?U*=a:L.object.isOrthographicCamera?(L.object.zoom=Math.max(L.minZoom,Math.min(L.maxZoom,L.object.zoom/a)),L.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),L.enableZoom=!1)}function i(a){X.set(a.clientX,a.clientY)}function j(a){ba.set(a.clientX,a.clientY)}function k(a){$.set(a.clientX,a.clientY)}function l(a){Y.set(a.clientX,a.clientY),Z.subVectors(Y,X).multiplyScalar(L.rotateSpeed);var b=L.domElement;e(2*Math.PI*Z.x/b.clientHeight),f(2*Math.PI*Z.y/b.clientHeight),X.copy(Y),L.update()}function m(a){ca.set(a.clientX,a.clientY),da.subVectors(ca,ba),0<da.y?g(d()):0>da.y&&h(d()),ba.copy(ca),L.update()}function n(a){_.set(a.clientX,a.clientY),aa.subVectors(_,$).multiplyScalar(L.panSpeed),ga(aa.x,aa.y),$.copy(_),L.update()}function o(){}function p(a){0>a.deltaY?h(d()):0<a.deltaY&&g(d()),L.update()}function q(a){var b=!1;switch(a.keyCode){case L.keys.UP:ga(0,L.keyPanSpeed),b=!0;break;case L.keys.BOTTOM:ga(0,-L.keyPanSpeed),b=!0;break;case L.keys.LEFT:ga(L.keyPanSpeed,0),b=!0;break;case L.keys.RIGHT:ga(-L.keyPanSpeed,0),b=!0;}b&&(a.preventDefault(),L.update())}function r(a){if(1==a.touches.length)X.set(a.touches[0].pageX,a.touches[0].pageY);else{var b=.5*(a.touches[0].pageX+a.touches[1].pageX),c=.5*(a.touches[0].pageY+a.touches[1].pageY);X.set(b,c)}}function s(a){if(1==a.touches.length)$.set(a.touches[0].pageX,a.touches[0].pageY);else{var b=.5*(a.touches[0].pageX+a.touches[1].pageX),c=.5*(a.touches[0].pageY+a.touches[1].pageY);$.set(b,c)}}function t(a){var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);ba.set(0,d)}function u(a){L.enableZoom&&t(a),L.enablePan&&s(a)}function v(a){L.enableZoom&&t(a),L.enableRotate&&r(a)}function w(a){if(1==a.touches.length)Y.set(a.touches[0].pageX,a.touches[0].pageY);else{var b=.5*(a.touches[0].pageX+a.touches[1].pageX),c=.5*(a.touches[0].pageY+a.touches[1].pageY);Y.set(b,c)}Z.subVectors(Y,X).multiplyScalar(L.rotateSpeed);var d=L.domElement;e(2*Math.PI*Z.x/d.clientHeight),f(2*Math.PI*Z.y/d.clientHeight),X.copy(Y)}function x(a){if(1==a.touches.length)_.set(a.touches[0].pageX,a.touches[0].pageY);else{var b=.5*(a.touches[0].pageX+a.touches[1].pageX),c=.5*(a.touches[0].pageY+a.touches[1].pageY);_.set(b,c)}aa.subVectors(_,$).multiplyScalar(L.panSpeed),ga(aa.x,aa.y),$.copy(_)}function y(a){var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);ca.set(0,d),da.set(0,Math.pow(ca.y/ba.y,L.zoomSpeed)),g(da.y),ba.copy(ca)}function z(a){L.enableZoom&&y(a),L.enablePan&&x(a)}function A(a){L.enableZoom&&y(a),L.enableRotate&&w(a)}function B(){}function C(a){if(!1!==L.enabled){switch(a.preventDefault(),L.domElement.focus?L.domElement.focus():window.focus(),a.button){case 0:switch(L.mouseButtons.LEFT){case THREE.MOUSE.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(!1===L.enablePan)return;k(a),Q=P.PAN}else{if(!1===L.enableRotate)return;i(a),Q=P.ROTATE}break;case THREE.MOUSE.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(!1===L.enableRotate)return;i(a),Q=P.ROTATE}else{if(!1===L.enablePan)return;k(a),Q=P.PAN}break;default:Q=P.NONE;}break;case 1:switch(L.mouseButtons.MIDDLE){case THREE.MOUSE.DOLLY:if(!1===L.enableZoom)return;j(a),Q=P.DOLLY;break;default:Q=P.NONE;}break;case 2:switch(L.mouseButtons.RIGHT){case THREE.MOUSE.ROTATE:if(!1===L.enableRotate)return;i(a),Q=P.ROTATE;break;case THREE.MOUSE.PAN:if(!1===L.enablePan)return;k(a),Q=P.PAN;break;default:Q=P.NONE;}}Q!==P.NONE&&(document.addEventListener("mousemove",D,!1),document.addEventListener("mouseup",E,!1),L.dispatchEvent(N))}}function D(a){if(!1!==L.enabled)switch(a.preventDefault(),Q){case P.ROTATE:if(!1===L.enableRotate)return;l(a);break;case P.DOLLY:if(!1===L.enableZoom)return;m(a);break;case P.PAN:if(!1===L.enablePan)return;n(a);}}function E(a){!1===L.enabled||(o(a),document.removeEventListener("mousemove",D,!1),document.removeEventListener("mouseup",E,!1),L.dispatchEvent(O),Q=P.NONE)}function F(a){!1===L.enabled||!1===L.enableZoom||Q!==P.NONE&&Q!==P.ROTATE||(a.preventDefault(),a.stopPropagation(),L.dispatchEvent(N),p(a),L.dispatchEvent(O))}function G(a){!1===L.enabled||!1===L.enableKeys||!1===L.enablePan||q(a)}function H(a){if(!1!==L.enabled){switch(a.preventDefault(),a.touches.length){case 1:switch(L.touches.ONE){case THREE.TOUCH.ROTATE:if(!1===L.enableRotate)return;r(a),Q=P.TOUCH_ROTATE;break;case THREE.TOUCH.PAN:if(!1===L.enablePan)return;s(a),Q=P.TOUCH_PAN;break;default:Q=P.NONE;}break;case 2:switch(L.touches.TWO){case THREE.TOUCH.DOLLY_PAN:if(!1===L.enableZoom&&!1===L.enablePan)return;u(a),Q=P.TOUCH_DOLLY_PAN;break;case THREE.TOUCH.DOLLY_ROTATE:if(!1===L.enableZoom&&!1===L.enableRotate)return;v(a),Q=P.TOUCH_DOLLY_ROTATE;break;default:Q=P.NONE;}break;default:Q=P.NONE;}Q!==P.NONE&&L.dispatchEvent(N)}}function I(a){if(!1!==L.enabled)switch(a.preventDefault(),a.stopPropagation(),Q){case P.TOUCH_ROTATE:if(!1===L.enableRotate)return;w(a),L.update();break;case P.TOUCH_PAN:if(!1===L.enablePan)return;x(a),L.update();break;case P.TOUCH_DOLLY_PAN:if(!1===L.enableZoom&&!1===L.enablePan)return;z(a),L.update();break;case P.TOUCH_DOLLY_ROTATE:if(!1===L.enableZoom&&!1===L.enableRotate)return;A(a),L.update();break;default:Q=P.NONE;}}function J(a){!1===L.enabled||(B(a),L.dispatchEvent(O),Q=P.NONE)}function K(a){!1===L.enabled||a.preventDefault()}b===void 0&&console.warn("THREE.OrbitControls: The second parameter \"domElement\" is now mandatory."),b===document&&console.error("THREE.OrbitControls: \"document\" should not be used as the target \"domElement\". Please use \"renderer.domElement\" instead."),this.object=a,this.domElement=b,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.ROTATE,MIDDLE:THREE.MOUSE.DOLLY,RIGHT:THREE.MOUSE.PAN},this.touches={ONE:THREE.TOUCH.ROTATE,TWO:THREE.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return S.phi},this.getAzimuthalAngle=function(){return S.theta},this.saveState=function(){L.target0.copy(L.target),L.position0.copy(L.object.position),L.zoom0=L.object.zoom},this.reset=function(){L.target.copy(L.target0),L.object.position.copy(L.position0),L.object.zoom=L.zoom0,L.object.updateProjectionMatrix(),L.dispatchEvent(M),L.update(),Q=P.NONE},this.update=function(){var b=new THREE.Vector3,d=new THREE.Quaternion().setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),f=d.clone().inverse(),g=new THREE.Vector3,h=new THREE.Quaternion;return function(){var a=L.object.position;return b.copy(a).sub(L.target),b.applyQuaternion(d),S.setFromVector3(b),L.autoRotate&&Q===P.NONE&&e(c()),L.enableDamping?(S.theta+=T.theta*L.dampingFactor,S.phi+=T.phi*L.dampingFactor):(S.theta+=T.theta,S.phi+=T.phi),S.theta=Math.max(L.minAzimuthAngle,Math.min(L.maxAzimuthAngle,S.theta)),S.phi=Math.max(L.minPolarAngle,Math.min(L.maxPolarAngle,S.phi)),S.makeSafe(),S.radius*=U,S.radius=Math.max(L.minDistance,Math.min(L.maxDistance,S.radius)),!0===L.enableDamping?L.target.addScaledVector(V,L.dampingFactor):L.target.add(V),b.setFromSpherical(S),b.applyQuaternion(f),a.copy(L.target).add(b),L.object.lookAt(L.target),!0===L.enableDamping?(T.theta*=1-L.dampingFactor,T.phi*=1-L.dampingFactor,V.multiplyScalar(1-L.dampingFactor)):(T.set(0,0,0),V.set(0,0,0)),U=1,!!(W||g.distanceToSquared(L.object.position)>R||8*(1-h.dot(L.object.quaternion))>R)&&(L.dispatchEvent(M),g.copy(L.object.position),h.copy(L.object.quaternion),W=!1,!0)}}(),this.dispose=function(){L.domElement.removeEventListener("contextmenu",K,!1),L.domElement.removeEventListener("mousedown",C,!1),L.domElement.removeEventListener("wheel",F,!1),L.domElement.removeEventListener("touchstart",H,!1),L.domElement.removeEventListener("touchend",J,!1),L.domElement.removeEventListener("touchmove",I,!1),document.removeEventListener("mousemove",D,!1),document.removeEventListener("mouseup",E,!1),L.domElement.removeEventListener("keydown",G,!1)};var L=this,M={type:"change"},N={type:"start"},O={type:"end"},P={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},Q=P.NONE,R=1e-6,S=new THREE.Spherical,T=new THREE.Spherical,U=1,V=new THREE.Vector3,W=!1,X=new THREE.Vector2,Y=new THREE.Vector2,Z=new THREE.Vector2,$=new THREE.Vector2,_=new THREE.Vector2,aa=new THREE.Vector2,ba=new THREE.Vector2,ca=new THREE.Vector2,da=new THREE.Vector2,ea=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0),a.multiplyScalar(-b),V.add(a)}}(),fa=function(){var a=new THREE.Vector3;return function(b,c){!0===L.screenSpacePanning?a.setFromMatrixColumn(c,1):(a.setFromMatrixColumn(c,0),a.crossVectors(L.object.up,a)),a.multiplyScalar(b),V.add(a)}}(),ga=function(){var a=new THREE.Vector3;return function(b,c){var d=L.domElement;if(L.object.isPerspectiveCamera){var e=L.object.position;a.copy(e).sub(L.target);var f=a.length();f*=Math.tan(L.object.fov/2*Math.PI/180),ea(2*b*f/d.clientHeight,L.object.matrix),fa(2*c*f/d.clientHeight,L.object.matrix)}else L.object.isOrthographicCamera?(ea(b*(L.object.right-L.object.left)/L.object.zoom/d.clientWidth,L.object.matrix),fa(c*(L.object.top-L.object.bottom)/L.object.zoom/d.clientHeight,L.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),L.enablePan=!1)}}();L.domElement.addEventListener("contextmenu",K,!1),L.domElement.addEventListener("mousedown",C,!1),L.domElement.addEventListener("wheel",F,!1),L.domElement.addEventListener("touchstart",H,!1),L.domElement.addEventListener("touchend",J,!1),L.domElement.addEventListener("touchmove",I,!1),L.domElement.addEventListener("keydown",G,!1),-1===L.domElement.tabIndex&&(L.domElement.tabIndex=0),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,THREE.MapControls=function(a,b){THREE.OrbitControls.call(this,a,b),this.mouseButtons.LEFT=THREE.MOUSE.PAN,this.mouseButtons.RIGHT=THREE.MOUSE.ROTATE,this.touches.ONE=THREE.TOUCH.PAN,this.touches.TWO=THREE.TOUCH.DOLLY_ROTATE},THREE.MapControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.MapControls.prototype.constructor=THREE.MapControls;